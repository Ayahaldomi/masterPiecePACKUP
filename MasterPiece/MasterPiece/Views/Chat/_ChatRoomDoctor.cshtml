@model IEnumerable<MasterPiece.Models.ChatRoom>
@{
    ViewBag.Title = "Your Patients' Chat Rooms";
}

@if (Model.Any())
{

    foreach (var chatRoom in Model)
    {
        <!--<tr>
            <td>@chatRoom.Patient.Full_Name</td>--> <!-- Display the patient's full name -->
            <!--<td>
                @(chatRoom.CreatedAt.HasValue
        ? chatRoom.CreatedAt.Value.ToString("MMMM dd, yyyy hh:mm tt")
        : "N/A")
            </td>--> <!-- Display the creation date of the chat room -->
            <!--<td>
                <a href="@Url.Action("Chat", "Chat", new { chatRoomId = chatRoom.ChatRoom_ID })" class="btn btn-primary">
                    Enter Chat
                </a>
            </td>
        </tr>-->

<li class="p-2 border-bottom chat-room-item" data-patient-name="@chatRoom.Patient.Full_Name.ToLower()" data-has-unread="@chatRoom.hasUnreadMessages">
    <script>console.log("@chatRoom.hasUnreadMessages")</script>
    <a href="@Url.Action("Chat", "Chat", new { chatRoomId = chatRoom.ChatRoom_ID })" class="d-flex justify-content-between">
        <div class="d-flex flex-row">
            <div>
                <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava1-bg.webp"
                     alt="avatar" class="d-flex align-self-center me-3" width="60">
                <span class="badge bg-success badge-dot"></span>
            </div>
            <div class="pt-1">
                <p class="fw-bold mb-0">@chatRoom.Patient.Full_Name</p>
                <p class="small text-muted">
                    @(chatRoom.CreatedAt.HasValue
                            ? chatRoom.CreatedAt.Value.ToString("MMMM dd, yyyy hh:mm tt")
                            : "N/A")
                </p>
            </div>
        </div>
        <div class="pt-1">
            @if (chatRoom.hasUnreadMessages == true)
            {
                <span class="badge bg-danger float-end" style="width: 10px; height: 20px; border-radius: 50%; display: inline-block;"> </span>
            }
        </div>
    </a>
</li>
    }

}
else
{
    <p>You do not have any active chat rooms with patients.</p>
}


